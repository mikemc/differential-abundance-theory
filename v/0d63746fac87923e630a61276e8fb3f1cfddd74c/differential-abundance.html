<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 How bias affects DA results | The effect of taxonomic bias on differential-abundance analysis in microbiome studies</title>
  <meta name="description" content="3 How bias affects DA results | The effect of taxonomic bias on differential-abundance analysis in microbiome studies" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 How bias affects DA results | The effect of taxonomic bias on differential-abundance analysis in microbiome studies" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 How bias affects DA results | The effect of taxonomic bias on differential-abundance analysis in microbiome studies" />
  
  
  

<meta name="author" content="Michael R. McLaren" />
<meta name="author" content="Jacob T. Nearing" />
<meta name="author" content="Amy D. Willis" />
<meta name="author" content="Karen G. Lloyd" />
<meta name="author" content="Benjamin J. Callahan" />


<meta name="date" content="2022-06-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="abundance-measurement.html"/>
<link rel="next" href="case-studies.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {extensions: ["cancel.js"]},
});
MathJax.Hub.Config({
    TeX: {
        Macros : {
            md: '^{\\times}\\!/',
        }
    },
});
</script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="abundance-measurement.html"><a href="abundance-measurement.html"><i class="fa fa-check"></i><b>2</b> How bias affects abundance measurements</a>
<ul>
<li class="chapter" data-level="2.1" data-path="abundance-measurement.html"><a href="abundance-measurement.html#model-of-mgs-measurement"><i class="fa fa-check"></i><b>2.1</b> Model of MGS measurement</a></li>
<li class="chapter" data-level="2.2" data-path="abundance-measurement.html"><a href="abundance-measurement.html#relative-abundance"><i class="fa fa-check"></i><b>2.2</b> Relative abundance</a></li>
<li class="chapter" data-level="2.3" data-path="abundance-measurement.html"><a href="abundance-measurement.html#absolute-abundance"><i class="fa fa-check"></i><b>2.3</b> Absolute abundance</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="abundance-measurement.html"><a href="abundance-measurement.html#leveraging-information-about-total-community-abundance"><i class="fa fa-check"></i><b>2.3.1</b> Leveraging information about total-community abundance</a></li>
<li class="chapter" data-level="2.3.2" data-path="abundance-measurement.html"><a href="abundance-measurement.html#leveraging-information-about-a-reference-species"><i class="fa fa-check"></i><b>2.3.2</b> Leveraging information about a reference species</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="differential-abundance.html"><a href="differential-abundance.html"><i class="fa fa-check"></i><b>3</b> How bias affects DA results</a>
<ul>
<li class="chapter" data-level="3.1" data-path="differential-abundance.html"><a href="differential-abundance.html#fold-change-between-a-pair-of-samples"><i class="fa fa-check"></i><b>3.1</b> Fold change between a pair of samples</a></li>
<li class="chapter" data-level="3.2" data-path="differential-abundance.html"><a href="differential-abundance.html#regression-analysis-of-many-samples"><i class="fa fa-check"></i><b>3.2</b> Regression analysis of many samples</a></li>
<li class="chapter" data-level="3.3" data-path="differential-abundance.html"><a href="differential-abundance.html#rank-based-analyses"><i class="fa fa-check"></i><b>3.3</b> Rank-based analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>4</b> Case studies  </a>
<ul>
<li class="chapter" data-level="4.1" data-path="case-studies.html"><a href="case-studies.html#foliar-fungi-experiment"><i class="fa fa-check"></i><b>4.1</b> Foliar fungi experiment</a></li>
<li class="chapter" data-level="4.2" data-path="case-studies.html"><a href="case-studies.html#vaginal-microbiomes-of-pregnant-women"><i class="fa fa-check"></i><b>4.2</b> Vaginal microbiomes of pregnant women</a></li>
<li class="chapter" data-level="4.3" data-path="case-studies.html"><a href="case-studies.html#human-gut-microbiomes"><i class="fa fa-check"></i><b>4.3</b> Human gut microbiomes</a></li>
<li class="chapter" data-level="4.4" data-path="case-studies.html"><a href="case-studies.html#microbial-growth-in-marine-sediments"><i class="fa fa-check"></i><b>4.4</b> Microbial growth in marine sediments</a></li>
<li class="chapter" data-level="4.5" data-path="case-studies.html"><a href="case-studies.html#summary-and-discussion"><i class="fa fa-check"></i><b>4.5</b> Summary and discussion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>5</b> Potential solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="solutions.html"><a href="solutions.html#ratio-based-relative-da-analysis"><i class="fa fa-check"></i><b>5.1</b> Ratio-based relative DA analysis</a></li>
<li class="chapter" data-level="5.2" data-path="solutions.html"><a href="solutions.html#calibrate-compositions"><i class="fa fa-check"></i><b>5.2</b> Calibration using community controls</a></li>
<li class="chapter" data-level="5.3" data-path="solutions.html"><a href="solutions.html#choose-absolute-abundance-methods-with-more-stable-fes"><i class="fa fa-check"></i><b>5.3</b> Choose absolute-abundance methods with more stable FEs</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="solutions.html"><a href="solutions.html#use-complementary-mgs-and-total-abundance-measurements"><i class="fa fa-check"></i><b>5.3.1</b> Use complementary MGS and total-abundance measurements</a></li>
<li class="chapter" data-level="5.3.2" data-path="solutions.html"><a href="solutions.html#normalize-to-a-reference-species"><i class="fa fa-check"></i><b>5.3.2</b> Normalize to a reference species</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="solutions.html"><a href="solutions.html#bias-sensitivity-analysis"><i class="fa fa-check"></i><b>5.4</b> Bias sensitivity analysis</a></li>
<li class="chapter" data-level="5.5" data-path="solutions.html"><a href="solutions.html#bias-aware-meta-analysis"><i class="fa fa-check"></i><b>5.5</b> Bias-aware meta-analysis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="mgs-measurement-details.html"><a href="mgs-measurement-details.html"><i class="fa fa-check"></i><b>A</b> MGS measurement details</a>
<ul>
<li class="chapter" data-level="A.1" data-path="mgs-measurement-details.html"><a href="mgs-measurement-details.html#spike-in-alt"><i class="fa fa-check"></i><b>A.1</b> Alternative method for measuring species absolute abundances from a spike-in</a></li>
<li class="chapter" data-level="A.2" data-path="mgs-measurement-details.html"><a href="mgs-measurement-details.html#multiple-references"><i class="fa fa-check"></i><b>A.2</b> Missing and multiple reference species</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-regression.html"><a href="appendix-regression.html"><i class="fa fa-check"></i><b>B</b> Linear regression</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appendix-regression.html"><a href="appendix-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>B.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="appendix-regression.html"><a href="appendix-regression.html#review-of-simple-linear-regression"><i class="fa fa-check"></i><b>B.1.1</b> Review of simple linear regression</a></li>
<li class="chapter" data-level="B.1.2" data-path="appendix-regression.html"><a href="appendix-regression.html#measurement-error-in-the-response"><i class="fa fa-check"></i><b>B.1.2</b> Measurement error in the response</a></li>
<li class="chapter" data-level="B.1.3" data-path="appendix-regression.html"><a href="appendix-regression.html#specific-application-to-taxonomic-bias"><i class="fa fa-check"></i><b>B.1.3</b> Specific application to taxonomic bias</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="appendix-regression.html"><a href="appendix-regression.html#gamma-poisson-regression"><i class="fa fa-check"></i><b>B.2</b> Gamma-Poisson regression</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="appendix-regression.html"><a href="appendix-regression.html#background"><i class="fa fa-check"></i><b>B.2.1</b> Background</a></li>
<li class="chapter" data-level="B.2.2" data-path="appendix-regression.html"><a href="appendix-regression.html#inferring-lfcs-in-proportions-with-and-without-bias-correction"><i class="fa fa-check"></i><b>B.2.2</b> Inferring LFCs in proportions with and without bias correction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="diversity-and-mean-efficiency.html"><a href="diversity-and-mean-efficiency.html"><i class="fa fa-check"></i><b>C</b> Alpha diversity and variation in the mean efficiency</a></li>
<li class="chapter" data-level="D" data-path="supplemental-figures.html"><a href="supplemental-figures.html"><i class="fa fa-check"></i><b>D</b> Supplemental figures</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The effect of taxonomic bias on differential-abundance analysis in microbiome studies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="differential-abundance" class="section level1" number="3">
<h1><span class="header-section-number">3</span> How bias affects DA results</h1>
<!-- Previous title: Differential-abundance methods vary in their robustness to taxonomic bias  -->
<p>We now turn to how the errors in MGS-based abundance measurements affect DA results.
Our focus is on <em>multiplicative DA</em>—the fold differences (FD) in the relative or absolute abundance of species between samples or between experimental conditions.
Multiplicative DA has a direct ecological interpretation via the multiplicative processes of exponential growth and decay and forms the basis for several popular DA methods (REF DESeq2, ALDEx2(?), and corncob; a LV paper; fido).
We also consider non-parametric rank-based methods; these methods are popular in case-control studies for which ecological interpretability is often of secondary importance to discovering stable associations between species and the condition of interest (REFs).</p>
<div id="fold-change-between-a-pair-of-samples" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Fold change between a pair of samples</h2>
<p>The building blocks of a multiplicative DA analysis are the measured FDs in a species’ abundance between pairs of individual samples.
<!-- The FE in the measured FD between two samples is given by the ratio of the FEs for the individual-sample measurements. -->
If the fold error (FE) in a species’ abundance measurement is constant across samples, then it will not affect the measured FDs between samples.
<!-- Ratios -->
In Section <a href="abundance-measurement.html#abundance-measurement">2</a>, we showed that consistent taxonomic bias creates a constant FE in the ratio between two species <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, equal to the ratio in their efficiencies (Equation <a href="abundance-measurement.html#eq:ratio-error">(2.9)</a>).
This error completely cancels when calculating the FD of this ratio from sample <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>,
<span class="math display" id="eq:ratio-fc-error">\[\begin{align}
  \tag{3.1}
\underbrace{\frac{\tilde R_{i/j}^{(b)}}{\tilde R_{i/j}^{(a)}}}_\text{measured FD}
  = \frac
    {R_{i/j}^{(b)} \cdot \cancel{B_i / B_j}}
    {R_{i/j}^{(a)} \cdot \cancel{B_i / B_j}}
  =
  \underbrace{\frac{R_{i/j}^{(b)}}{R_{i/j}^{(a)}}}_\text{actual FD}
  .
\end{align}\]</span>
<!-- Proportions -->
In contrast, bias created a FE in the proportion of a species (Equation <a href="abundance-measurement.html#eq:prop-error">(2.7)</a>) that varied inversely with the mean efficiency of the sample.
Therefore, this error does not cancel when calculating the FD in the proportion,
<span class="math display" id="eq:prop-fc-error">\[\begin{align}
  \tag{3.2}
\underbrace{\frac{\tilde P_i^{(b)}}{\tilde P_i^{(a)}}}_\text{measured FD}
  = \frac
    {P_i(b) \cdot \cancel{B_i} / \bar B^{(b)}}
    {P_i(a) \cdot \cancel{B_i} / \bar B^{(a)}}
  =
  \underbrace{\frac{P_i^{(b)}}{P_i^{(a)}}}_\text{actual FD}
  \cdot
  \underbrace{\left[\frac{\bar B^{(b)}}{\bar B^{(a)}}\right]^{-1}}_\text{FE}
  .
\end{align}\]</span>
The varying mean efficiency does not cancel, leaving an FE in the FD of the species’ proportion that is equal to the inverse FD in the mean efficiency.
Notably, this FE is the same for every species.</p>
<p>The different effects of taxonomic bias on the measured FDs in proportions versus ratios are illustrated in a hypothetical example in Figure <a href="abundance-measurement.html#fig:error-proportions">2.1</a> (bottom row).
In this example, the mean efficiency decreases 2.6-fold from Sample 1 to Sample 2 (FD of 0.4), causing the FD in the proportion of each species to appear 2.6-fold larger than its true value.
Though the FE in the FD is the same for each species, the biological implications of the error vary.
In particular, there are three distinct types of error: an increase in the magnitude of the measured FD, a decrease in that magnitude, and a change in the direction of the FD.
We refer to the latter as a <em>sign error</em> in reference to the sign of the measured log fold difference (LFD).
We can see each type of error in Figure <a href="abundance-measurement.html#fig:error-proportions">2.1</a>.
For Species 1, which increases in abundance and thus moves in the opposite direction of the mean efficiency, we see an increase in magnitude of the measured FD (actual FD: 2.3, measured FD: 6.5).
For Species 2, which decreases and thus moves in the same direction as the mean efficiency but by a larger factor, we see a decrease in magnitude (actual FD: 0.15, measured FD: 0.44).
For Species 2, which decreases by a smaller factor than the mean efficiency, we see a change in direction (actual FD: 0.6, measured FD: 1.8), such that the species actually appears to increase (a sign error).
In contrast, the ratios between species change by the same factors in the actual and measured taxonomic profiles.
For example, the ratio of Species 2 to Species 3 changes from <span class="math inline">\(1/1\)</span> to <span class="math inline">\(1/4\)</span> in the actual profiles and from <span class="math inline">\(3\)</span> to <span class="math inline">\(3/4\)</span> in the measured profiles, a decrease by 4-fold either way.</p>
<!-- The ratios in sample 1 are Actual: 1:1:1, Observed: 1:18:6 -->
<!-- The ratios in sample 2 are Actual: 15:1:4, Observed: 5:6:8 -->
<p>Taxonomic bias affects the measured FDs in a species’ absolute abundance in a similar fashion.
First, consider a species’ abundance measurement <span class="math inline">\(\tilde A_i^{(a)}\)</span> derived from a non-MGS measurement of total-community abundance using Equation <a href="abundance-measurement.html#eq:density-prop-meas">(2.11)</a>.
Equation <a href="abundance-measurement.html#eq:density-prop-error">(2.13)</a> indicates that the FE in this measurement equals the (constant) species efficiency multiplied by <span class="math inline">\({B^{{\text{[tot]}}(a)}}/{\bar B^{(a)}}\)</span>, the ratio of the mean efficiency of the total-abundance measurement to that of the MGS measurement.
This ratio can vary, creating error in the measured FD between samples.
Notably, if the FDs in the mean efficiency of the total-abundance measurement mirrors that of the MGS measurement, then the two offset each other and lead to more stable FEs (and hence more accurate FDs) in <span class="math inline">\(\tilde A_i^{(a)}\)</span>.
We discuss how this possibility might be exploited in real experimental workflows in Section <a href="solutions.html#solutions">5</a>.</p>
<p>Now consider a species’ abundance derived from a reference species using Equation <a href="abundance-measurement.html#eq:density-ratio-meas">(2.14)</a>.
Equation <a href="abundance-measurement.html#eq:density-ratio-error">(2.15)</a> indicates that the FE equals a constant ratio in species’ efficiencies multiplied by the FE in the measurement of the reference species’ abundance.
If the abundance of the reference species can determined up to constant FE, then the FE in <span class="math inline">\(\tilde A_i^{(a)}\)</span> will also be constant, leading to accurate FDs.</p>
</div>
<div id="regression-analysis-of-many-samples" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Regression analysis of many samples</h2>
<p>Most DA analyses can be understood as a regression analysis.
For example, the simple linear regression model,
<span class="math display" id="eq:regression">\[\begin{align}
  \tag{3.3}
  y^{(a)} = \alpha + \beta x^{(a)} + \varepsilon^{(a)},
\end{align}\]</span>
can be used to relate a microbial abundance variable <span class="math inline">\(y\)</span> to a <em>covariate</em> <span class="math inline">\(x\)</span> and the <em>residual (or unexplained) error</em> <span class="math inline">\(\varepsilon\)</span>.
For example, <span class="math inline">\(y\)</span> may be the log absolute abundance of species <span class="math inline">\(i\)</span> (<span class="math inline">\(\log A_i^{(a)}\)</span>) and <span class="math inline">\(x\)</span> may be a continuous variable (such as pH) or a binary variable (such as <span class="math inline">\(x=1\)</span> for treated patients and <span class="math inline">\(x=0\)</span> for untreated controls).
The regression coefficients <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are parameters to be estimated from the data.
A DA analysis is primarily interested in the slope coefficient <span class="math inline">\(\beta\)</span>, which determines how the average or expected value of <span class="math inline">\(y\)</span> increases with <span class="math inline">\(x\)</span>.
For a binary covariate, <span class="math inline">\(\beta\)</span> equals the average difference in <span class="math inline">\(y\)</span> between samples with <span class="math inline">\(x=1\)</span> versus those with <span class="math inline">\(x=0\)</span>.
Taking the response <span class="math inline">\(y\)</span> to be the logarithm of a species’ relative or absolute abundance makes the DA analysis multiplicative, with the coefficient <span class="math inline">\(\beta\)</span> corresponding to the average log fold difference (LFD) in abundance between conditions or for a unit increase in <span class="math inline">\(x\)</span>.</p>
<p>Appendix <a href="appendix-regression.html#appendix-regression">B</a> derives mathematical results for the effect that measurement error in the response caused by taxonomic bias has on LFDs estimated via simple linear regression.
Here we illustrate these results with an example.
Suppose that we wish to estimate the average LFD in the absolute abundance of every species between samples from two conditions, such as treated and untreated patients.
Further suppose that we have measured absolute abundances by multiplying the proportions from MGS with an accurate measurement of total-community abundance.
For each species <span class="math inline">\(i\)</span>, we set <span class="math inline">\(y^{(a)}\)</span> in Equation <a href="differential-abundance.html#eq:regression">(3.3)</a> equal to <span class="math inline">\(\log \tilde A_{i}^{(a)}\)</span>, and use either Ordinary Least Squares (OLS) or Maximum Likelihood Estimation (MLE) to estimate the coefficients <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.
From Equation <a href="abundance-measurement.html#eq:density-prop-error">(2.13)</a>, we know that the FE in the abundance of each species equals its efficiency relative to the mean efficiency of the sample.</p>
<p>To understand how the FE in species abundances affects the estimated LFD for a given species, it is useful to consider three possible scenarios for how the mean efficiency varies across samples.
In the first scenario, the mean efficiency remains stable across samples, such that the FE in <span class="math inline">\(\log \tilde A_{i}^{(a)}\)</span> is approximately constant.
In this case, the FE induced by bias <em>mostly cancels</em> and does not substantially affect the estimated LFD.
In the second scenario, the mean efficiency varies substantially but is not associated with the condition, creating random FEs in the individual sample measurements.
In this case, the LFDs between individual samples will be highly distorted, but these errors will effectively average out in the regression and the estimated LFD remains reliable.
Although the random FEs caused by bias do not create a systematic error in the LFD estimate, they will tend to reduce the precision (i.e., increase the standard error) of the estimate.
In the third scenario, the mean efficiency systematically varies with the condition, causing a systematic error in the estimated LFD regardless of the number of samples.
In particular, the portion of additive variation in the log mean efficiency that is linearly associated with <span class="math inline">\(x\)</span> creates an equal but opposite additive error in the estimated LFD for each species.
Although the absolute additive error in the LFDs is the same for all species, its biological significance varies, depending on its magnitude relative to that of the species’ true LFD.</p>
<p>Figure <a href="differential-abundance.html#fig:regression-example">3.1</a> shows a simulated example in which the mean efficiency varies systematically with the condition of interest.
Here, the average log mean efficiency is higher in the condition corresponding to <span class="math inline">\(x=1\)</span>, due to an increase of the high-efficiency Species 9.
This systematic increase in the log mean efficiency causes an artificial decrease in the estimated LFD for each species by an equal amount.
As we saw for the FD between individual samples, the biological significance of the systematic error in the LFD estimates varies by species, despite the absolute error being constant across species.
We see decreases in the magnitude of the LFD estimate (Species 9, 10, and 1 in Figure <a href="differential-abundance.html#fig:regression-example">3.1</a>), changes in sign (Species 5), or increases in magnitude (remaining species) depending the value of the actual LFD relative to the error.
The portion of the variation in the log mean efficiency that is uncorrelated with <span class="math inline">\(x\)</span> increases the standard errors for most species (Figure <a href="differential-abundance.html#fig:regression-example">3.1</a> D).
The exception is Species 9, which is the primary driver of the mean efficiency dynamics in this example.
Decreased magnitudes and increased standard errors can both cause associations to be missed that would otherwise have been detected (Species 10 and 1), while increased magnitudes can turn weak or statistically insignificant associations into strong and statistically significant ones (Species 7, 6 and 4).</p>
<!-- Figure: Regression example -->
<div class="figure"><span style="display:block;" id="fig:regression-example"></span>
<img src="notebook/_posts/2021-08-03-simulate-regression-example/simulate-regression-example_files/figure-html5/main-figure-1.svg" alt="Taxonomic bias distorts multi-sample differential abundance inference when the mean efficiency of samples is associated with the covariate of interest. This figure shows the results of a regression analysis of simulated microbiomes consisting of 50 samples and 10 species from two environmental conditions indexed by \(x=0\) and \(x=1\). In this simulation, the species with the largest efficiency (Species 9) also has the largest positive LFC, which drives the positive association of the log mean efficiency with the condition (shown in Panels A and B). This positive LFC in the log mean efficiency induces a systematic negative shift in the estimated LFCs of all species (Panels C and D). Panel D shows the mean LFC (points) with 95% confidence intervals (CIs), for each species estimated from either the actual or the measured densities. The error (difference in LFC estimates on measured and actual) equals the negative LFC of the mean efficiency (shown in Panel B)."  />
<p class="caption">
Figure 3.1: <strong>Taxonomic bias distorts multi-sample differential abundance inference when the mean efficiency of samples is associated with the covariate of interest.</strong> This figure shows the results of a regression analysis of simulated microbiomes consisting of 50 samples and 10 species from two environmental conditions indexed by <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=1\)</span>. In this simulation, the species with the largest efficiency (Species 9) also has the largest positive LFC, which drives the positive association of the log mean efficiency with the condition (shown in Panels A and B). This positive LFC in the log mean efficiency induces a systematic negative shift in the estimated LFCs of all species (Panels C and D). Panel D shows the mean LFC (points) with 95% confidence intervals (CIs), for each species estimated from either the actual or the measured densities. The error (difference in LFC estimates on measured and actual) equals the negative LFC of the mean efficiency (shown in Panel B).
</p>
</div>

<!-- end Figure -->
</div>
<div id="rank-based-analyses" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Rank-based analyses</h2>
<p>Rank-based or ‘nonparametric’ DA methods work by first applying a cross-sample rank-transformation to the abundance variable <span class="math inline">\(y\)</span>: The sample in which <span class="math inline">\(y\)</span> has the smallest value receives a rank of 1, the sample with the second smallest value receives a rank of 2, etc.
These methods then analyze how the average rank varies across conditions.
Rank-based methods commonly used in microbiome DA analysis include the Wilcoxon-Mann-Whitney and Kruskal-Wallis tests for a discrete covariate (e.g. case vs control) and Spearman’s rank correlation for a continuous covariate (e.g. pH).
They have been applied to species proportions (REFs), ratios (REFs), and absolute abundances (REFs).</p>
<p>Multiplying a variable by a constant factor does not change its cross-sample ranks; thus rank-based DA methods are unaffected by constant FE in the abundance variable <span class="math inline">\(y\)</span>.
We therefore conclude that consistent taxonomic bias does not affect rank-based DA analyses of species ratios or absolute abundances derived from a reference species.
In contrast, variable FE in <span class="math inline">\(y\)</span> (driven by variation in the mean efficiency) can affect the cross-sample ranks; if the FE is associated with the covariate <span class="math inline">\(x\)</span>, it can cause systematic error in the DA result.
Thus consistent bias may impact rank-based analyses of species proportions and absolute abundances derived from a total-community abundance measurement.
Future work should consider whether rank-based DA methods are significantly more robust than multiplicative DA methods to variation in the mean efficiency.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="abundance-measurement.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-studies.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikemc/differential-abundance-theory/edit/main/differential-abundance.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/mikemc/differential-abundance-theory/commits/main/differential-abundance.Rmd",
"text": null
},
"view": {
"link": "https://github.com/mikemc/differential-abundance-theory/blob/main/differential-abundance.Rmd",
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
